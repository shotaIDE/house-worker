# 家事一覧タブ要件定義

## 概要

家事一覧タブは、ユーザーが登録した全ての家事を一覧表示し、家事の登録・完了・詳細確認・削除などの操作を行うための画面です。ホーム画面のタブの一つとして実装されます。

## 機能要件

### 表示要件

1. **家事一覧の表示**

   - 登録されている全ての家事を、登録日時が新しい順（降順）に表示する
   - 各家事アイテムには以下の情報を表示する
     - 家事の名前
     - 家事のアイコン（絵文字）

2. **空の状態の表示**

   - 登録されている家事がない場合は、適切なメッセージとアイコンを表示する
   - 例: 「登録されている家事はありません」というメッセージと、関連するアイコンを表示

3. **読み込み中の表示**

   - データ取得中はスケルトンアイテムを 10 件表示する
   - スケルトンアイテムの作り方は、home_screen.dart の`\_QuickRegisterBottomBarState` における `Skeletonizer` を参考にする

4. **エラー状態の表示**
   - データ取得に失敗した場合は、エラーメッセージを表示する

### 操作要件

1. **家事の完了登録**

   - 家事アイテムの左側がタップされた際、その家事の家事ログを現在時刻で登録する
   - 登録成功時は以下のような適切なフィードバックを表示する
     - スナックバーでの通知
     - 家事ログのタブをハイライトする

2. **家事詳細の表示**

   - 家事アイテムの右側がタップされた際、その家事の家事ダッシュボードに遷移する
   - 家事ダッシュボードでは、家事の詳細情報や完了履歴を確認できる

3. **家事の削除**

   - 家事アイテムが左スワイプされた際、確認ダイアログを表示する
   - 確認後、家事を削除する
   - 削除成功時は適切なフィードバック（例: スナックバーでの通知）を表示する

4. **一覧の更新**
   - プルダウンで一覧を更新できる（プルトゥリフレッシュ）

## データ要件

1. **家事モデル（HouseWork）**

   - id: 家事の ID（文字列）
   - title: 家事の名前（文字列）
   - icon: 家事のアイコン（絵文字、文字列）
   - createdAt: 家事の作成日時（DateTime）
   - createdBy: 家事の作成者 ID（文字列）
   - isRecurring: 定期的な家事かどうか（真偽値）
   - recurringIntervalMs: 定期的な家事の場合の間隔（ミリ秒、整数、オプション）

2. **家事ログモデル（WorkLog）**
   - id: 家事ログの ID（文字列）
   - houseWorkId: 関連する家事の ID（文字列）
   - completedAt: 完了時刻（DateTime）
   - completedBy: 実行したユーザーの ID（文字列）

## UI 要件

1. **レイアウト**

   - リスト形式で家事を表示する
   - アイテム間には Divider と適切な余白を設ける

2. **家事アイテムのデザイン**

   - 左側に、順番に完了アイコン、家事のアイコン、家事の名前を表示する
   - 右側に、家事の詳細を表示するためのアイコンを配置する
   - タップ可能な領域を明確にする（左側と右側で異なる動作をするため）

3. **アクセシビリティ**
   - 十分なコントラストを確保する
   - タップ領域は十分な大きさを確保する（最低 44x44 ポイント）
   - スクリーンリーダー対応のためのセマンティックラベルを提供する

## 状態管理

1. **家事一覧の取得**

   - Riverpod を使用して家事一覧を取得する
   - 家事リポジトリから、作成日時の新しい順に家事を取得する
   - 非同期データの読み込み中、エラー、データ取得成功の各状態を適切に処理する

2. **家事の完了登録**

   - 家事ログリポジトリを使用して、家事ログを登録する
   - 登録後、一覧を更新する

3. **家事の削除**
   - 家事リポジトリを使用して、家事を削除する
   - 削除後、一覧を更新する

## エラー処理

1. **データ取得エラー**

   - データ取得に失敗した場合、エラーメッセージを表示する
   - 再試行の選択肢を提供する

2. **操作エラー**
   - 家事の完了登録や削除に失敗した場合、エラーメッセージを表示する
   - 可能な場合は、エラーの原因と対処方法を提示する

## 制約条件

1. **家事数の制限**

   - 無料ユーザーは最大 10 件までの家事しか登録できない
   - 制限に達した場合、Pro 版へのアップグレードを促すダイアログを表示する

2. **パフォーマンス**
   - 大量の家事がある場合でも、スムーズにスクロールできるようにする
   - データの取得と表示を最適化する

## 関連する画面・機能

1. **家事ダッシュボード画面**

   - 家事アイテムの右側タップで遷移する画面
   - 家事の詳細情報や完了履歴を表示する

2. **家事追加画面**

   - フローティングアクションボタンから遷移する画面
   - 家事名とアイコンを設定して新しい家事を登録できる

3. **完了した家事ログ一覧タブ**
   - 完了した家事ログを時系列で表示するタブ
   - 家事一覧タブと並んで表示される

## 技術的な実装ポイント

1. **リポジトリの修正**

   - `house_work_repository.dart`の`getAll()`メソッドを修正し、`createdBy`ではなく`createdAt`でソートするようにする
   - ソート順は降順（descending: true）とする

2. **UI 実装**

   - 家事アイテムの左側と右側で異なる動作をするため、適切にタップ領域を分割する
   - スワイプで削除する機能を実装する際は、確認ダイアログを表示する

3. **状態管理**
   - Riverpod を使用して、家事一覧の状態を管理する
   - 家事の追加・削除・完了登録などの操作後、適切に状態を更新する

## 将来的な拡張性

1. **家事の検索機能**

   - 家事名やアイコンで検索できる機能を追加する可能性がある

2. **家事のフィルタリング機能**

   - 特定の条件（例: 作成者、頻度など）で家事をフィルタリングする機能を追加する可能性がある

3. **家事の並び替え機能**
   - 作成日時以外の条件（例: 名前、完了回数など）で家事を並び替える機能を追加する可能性がある
