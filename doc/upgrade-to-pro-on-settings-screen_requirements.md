# 設定画面からのプロ版アップグレード機能の要件定義

## 概要

設定画面からプロ版へのアップグレード機能を追加し、現在のプラン（フリー版/プロ版）を表示する機能を実装する。

## 背景

現在、プロ版へのアップグレードは専用の画面（`UpgradeToProScreen`）から行うことができるが、設定画面からはアクセスできない。また、設定画面では現在のプラン（フリー版/プロ版）が表示されていない。

## 要件

### 1. 設定画面でのプラン表示

- 設定画面の「アプリについて」セクションに「現在のプラン」の項目を追加する
- 現在のプランに応じて以下の情報を表示する
  - フリー版の場合：「フリー版」と表示
  - プロ版の場合：「Pro 版」と表示
- プランの表示は視覚的に区別できるようにする（アイコンや色の使用）
  - フリー版：標準的なアイコン（例：`Icons.person`）
  - プロ版：プレミアム感のあるアイコン（例：`Icons.workspace_premium`）と金色などの特別な色

### 2. プロ版へのアップグレードボタン

- フリー版ユーザーの場合のみ、「プロ版にアップグレード」ボタンを表示する
- プロ版ユーザーの場合は、アップグレードボタンを表示しない
- アップグレードボタンは目立つデザインにする（プライマリーカラーの使用など）
- ボタンの配置は「現在のプラン」表示の近くに配置する

### 3. アップグレード機能の実装

- アップグレードボタンをタップすると、既存の`UpgradeToProScreen`に遷移する
- `UpgradeToProScreen`での購入処理は既存の実装を利用する
- 購入完了後、設定画面に戻った際に正しいプラン表示に更新されていること

### 4. エラーハンドリング

- 購入処理中にエラーが発生した場合、適切なエラーメッセージを表示する
- ネットワーク接続がない場合のエラー処理
- 購入処理がキャンセルされた場合の処理

### 5. プラン情報の更新

- アプリ起動時にプラン情報を取得・更新する
- バックグラウンドからフォアグラウンドに戻った際にプラン情報を再取得する
- プラン情報の変更があった場合、UI 表示をリアルタイムで更新する

## 非機能要件

### 1. パフォーマンス

- プラン情報の取得は非同期で行い、UI 表示をブロックしない
- プラン情報取得中はスケルトンローディングなどを表示する

### 2. セキュリティ

- プラン情報はセキュアに保存・管理する
- 不正なプラン変更ができないよう、サーバーサイドでの検証を行う

### 3. ユーザビリティ

- プラン表示は一目で現在の状態がわかるようにする
- アップグレードボタンは操作しやすい大きさと配置にする
- アップグレード画面への遷移はスムーズに行う

### 4. アクセシビリティ

- プラン表示には適切なコントラスト比を確保する
- アップグレードボタンには適切なツールチップを設定する
- スクリーンリーダー対応のためのセマンティックラベルを設定する

## 制約事項

- RevenueCat を使用した既存の課金システムを活用する
- 現在のアプリデザインとの一貫性を保つ
- Flutter/Riverpod のベストプラクティスに従う実装を行う

## 想定される画面遷移

1. 設定画面で「プロ版にアップグレード」ボタンをタップ
2. `UpgradeToProScreen`に遷移
3. 購入処理を実行
4. 購入完了後、設定画面に戻る（プラン表示が「プロ版」に更新される）
